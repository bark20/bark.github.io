# 서울시 편의시설 분포 현황_mid project 


사용할 파일
- df_fac.csv
- df_fac_coin.csv
- df_fac_pharm.csv
- df_fac_store.csv

사용할 라이브러리

import pandas as pd
import numpy as np
from glob import glob

from urllib.request import urlopen
import json

import folium

마크다운에서 15, 16 시각화 부분으로 바로 보시면 됩니다.

# 라이브러리 불러오기 및 데이터 불러오기 


```python
import pandas as pd
import numpy as np
from glob import glob

from urllib.request import urlopen
import json

# 지도 시각화를 위한 라이브러리
import folium

# 위도경도 변환을 위한 라이브러리
import pyproj

```


```python
file = glob("*")
file = sorted(file)
file
```




    ['Untitled.ipynb',
     'code_new.xlsx',
     'df_fac.csv',
     'df_fac_coin.csv',
     'df_fac_pharm.csv',
     'df_fac_store.csv',
     'dong_code.csv',
     'eStatutory_dong_code.csv',
     'home_fac.ipynb',
     'seoul_store.csv',
     '법정동코드 조회자료.xls',
     '서울시세탁소정보.csv',
     '서울시약국정보.csv',
     '서울시휴게시설정보.csv',
     '전체데이터프레임.csv',
     '통합 파일',
     '통합2']




```python
# 세탁소 정보 불러오기
coin = pd.read_csv("서울시세탁소정보.csv", encoding = "cp949")
coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>조건부허가신고사유</th>
      <th>조건부허가시작일자</th>
      <th>조건부허가종료일자</th>
      <th>건물소유구분명</th>
      <th>세탁기수</th>
      <th>여성종사자수</th>
      <th>남성종사자수</th>
      <th>회수건조수</th>
      <th>침대수</th>
      <th>다중이용업소여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3150000</td>
      <td>3150000-205-1987-01718</td>
      <td>19870922</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3160000</td>
      <td>3160000-205-2011-00007</td>
      <td>20110826</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3210000</td>
      <td>3210000-205-2008-00021</td>
      <td>20080819</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3210000</td>
      <td>3210000-205-1987-01754</td>
      <td>19870921</td>
      <td>NaN</td>
      <td>3</td>
      <td>폐업</td>
      <td>2</td>
      <td>폐업</td>
      <td>20220124</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3160000</td>
      <td>3160000-205-2005-00005</td>
      <td>20050318</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15151</th>
      <td>3160000</td>
      <td>3160000-205-1987-01808</td>
      <td>19870506</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15152</th>
      <td>3210000</td>
      <td>3210000-205-2005-00010</td>
      <td>20050613</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15153</th>
      <td>3100000</td>
      <td>3100000-205-1987-01340</td>
      <td>19870619</td>
      <td>NaN</td>
      <td>3</td>
      <td>폐업</td>
      <td>2</td>
      <td>폐업</td>
      <td>20220630</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15154</th>
      <td>3100000</td>
      <td>3100000-205-2013-00003</td>
      <td>20130613</td>
      <td>NaN</td>
      <td>3</td>
      <td>폐업</td>
      <td>2</td>
      <td>폐업</td>
      <td>20220715</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15155</th>
      <td>3160000</td>
      <td>3160000-205-1987-01816</td>
      <td>19870508</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>15156 rows × 47 columns</p>
</div>




```python
# 약국 정보 불러오기
pharm = pd.read_csv("서울시약국정보.csv", encoding = "cp949")
pharm.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>도로명우편번호</th>
      <th>사업장명</th>
      <th>최종수정일자</th>
      <th>데이터갱신구분</th>
      <th>데이터갱신일자</th>
      <th>업태구분명</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
      <th>약국영업면적</th>
      <th>지정일자</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3010000</td>
      <td>PHMD119803010033084000094</td>
      <td>19800303</td>
      <td>NaN</td>
      <td>3</td>
      <td>폐업</td>
      <td>3</td>
      <td>폐업</td>
      <td>19801021</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>충남약국</td>
      <td>20090212092610</td>
      <td>I</td>
      <td>2018-08-31 23:59:59.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21.76</td>
      <td>19800303.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3010000</td>
      <td>PHMD119863010033084000007</td>
      <td>19861120</td>
      <td>NaN</td>
      <td>3</td>
      <td>폐업</td>
      <td>3</td>
      <td>폐업</td>
      <td>19870409</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>이약국</td>
      <td>20090203101112</td>
      <td>I</td>
      <td>2018-08-31 23:59:59.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.30</td>
      <td>19861120.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 27 columns</p>
</div>




```python
# 편의점 정보 불러오기
store = pd.read_csv("seoul_store.csv")
store.head(2)
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/1337915206.py:2: DtypeWarning: Columns (13,36,41,42) have mixed types. Specify dtype option on import or set low_memory=False.
      store = pd.read_csv("seoul_store.csv")
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>공장판매직종업원수</th>
      <th>공장생산직종업원수</th>
      <th>건물소유구분명</th>
      <th>보증액</th>
      <th>월세액</th>
      <th>다중이용업소여부</th>
      <th>시설총규모</th>
      <th>전통업소지정번호</th>
      <th>전통업소주된음식</th>
      <th>홈페이지</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3130000</td>
      <td>3130000-104-2022-00101</td>
      <td>20220422</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3120000</td>
      <td>3120000-104-2023-00006</td>
      <td>20230110</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 44 columns</p>
</div>



# 데이터 전처리

## 코인세탁소 정보 전처리


```python
# 폐업처리 사업장 제거
coin = coin.loc[~coin["영업상태명"].str.contains("폐업"), :]
```


```python
# 사업장명 unique값 확인
# 유니크값이 너무 많아서 확인 불가
coin["사업장명"].unique()
```




    array(['화곡세탁소', '백조', '백양세탁', ..., '기름이 맑은세탁', '꽃길', '양재전자크리닝'],
          dtype=object)




```python
# 사업자명 컬럼으로 변경
# 무인|24|코인|빨래방|세탁방|셀프|유니룩스|크린|워시|월드씨앤에프|월드크리닝
coin = coin.loc[coin["사업장명"].str.contains("무인|24|코인|빨래방|세탁방|셀프|유니룩스|크린|워시|월드씨앤에프|월드크리닝")]
coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>조건부허가신고사유</th>
      <th>조건부허가시작일자</th>
      <th>조건부허가종료일자</th>
      <th>건물소유구분명</th>
      <th>세탁기수</th>
      <th>여성종사자수</th>
      <th>남성종사자수</th>
      <th>회수건조수</th>
      <th>침대수</th>
      <th>다중이용업소여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>3040000</td>
      <td>3040000-205-2022-00002</td>
      <td>20220414</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>49</th>
      <td>3160000</td>
      <td>3160000-205-1998-02087</td>
      <td>19980828</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68</th>
      <td>3060000</td>
      <td>3060000-205-2019-00005</td>
      <td>20191219</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>103</th>
      <td>3190000</td>
      <td>3190000-205-2008-00007</td>
      <td>20080813</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>105</th>
      <td>3090000</td>
      <td>3090000-205-2010-00009</td>
      <td>20101116</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14440</th>
      <td>3240000</td>
      <td>3240000-205-2012-00002</td>
      <td>20120305</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>임대</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>14442</th>
      <td>3240000</td>
      <td>3240000-205-2004-00022</td>
      <td>20041013</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>N</td>
    </tr>
    <tr>
      <th>14447</th>
      <td>3240000</td>
      <td>3240000-205-2011-00005</td>
      <td>20110629</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15073</th>
      <td>3240000</td>
      <td>3240000-205-2011-00008</td>
      <td>20111207</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15113</th>
      <td>3240000</td>
      <td>3240000-205-2018-00001</td>
      <td>20180102</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>271 rows × 47 columns</p>
</div>




```python
# 필요한 컬럼만 추출
coin = coin[["사업장명", "지번주소","좌표정보(X)","좌표정보(Y)"]].reset_index(drop = True)
coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>서울특별시 광진구 중곡동 80-24</td>
      <td>207768.461525</td>
      <td>450541.996110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>서울특별시 구로구 개봉동 60-70</td>
      <td>186184.211193</td>
      <td>444289.107238</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>서울특별시 중랑구 묵동 300-1 상록수한의원</td>
      <td>206917.833161</td>
      <td>457023.152884</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>서울특별시 동작구 상도동 436 래미안상도3차아파트</td>
      <td>195766.388348</td>
      <td>444020.397472</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>서울특별시 도봉구 창동 630-24 제1층</td>
      <td>203058.014515</td>
      <td>460009.769693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>266</th>
      <td>동명크린</td>
      <td>서울특별시 강동구 천호동 450-23 1층</td>
      <td>211492.872614</td>
      <td>448344.663122</td>
    </tr>
    <tr>
      <th>267</th>
      <td>크린나이스 강동점</td>
      <td>서울특별시 강동구 천호동 163-14번지 우정에쉐르 1층 104호</td>
      <td>211707.791367</td>
      <td>448419.291729</td>
    </tr>
    <tr>
      <th>268</th>
      <td>월드크린</td>
      <td>서울특별시 강동구 천호동 414 두산위브106호</td>
      <td>211154.188038</td>
      <td>448580.889486</td>
    </tr>
    <tr>
      <th>269</th>
      <td>크린에이드</td>
      <td>서울특별시 강동구 길동 99-4</td>
      <td>212952.113997</td>
      <td>448698.829639</td>
    </tr>
    <tr>
      <th>270</th>
      <td>명성명품크린</td>
      <td>서울특별시 강동구 명일동 15 삼익그린맨션 2차상가 103호</td>
      <td>213048.692180</td>
      <td>450124.105735</td>
    </tr>
  </tbody>
</table>
<p>271 rows × 4 columns</p>
</div>




```python
# 널값 확인
coin.isnull().sum()
```




    사업장명       0
    지번주소       1
    좌표정보(X)    1
    좌표정보(Y)    1
    dtype: int64




```python
# 널값 제거
coin = coin.dropna()
coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>서울특별시 광진구 중곡동 80-24</td>
      <td>207768.461525</td>
      <td>450541.996110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>서울특별시 구로구 개봉동 60-70</td>
      <td>186184.211193</td>
      <td>444289.107238</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>서울특별시 중랑구 묵동 300-1 상록수한의원</td>
      <td>206917.833161</td>
      <td>457023.152884</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>서울특별시 동작구 상도동 436 래미안상도3차아파트</td>
      <td>195766.388348</td>
      <td>444020.397472</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>서울특별시 도봉구 창동 630-24 제1층</td>
      <td>203058.014515</td>
      <td>460009.769693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>266</th>
      <td>동명크린</td>
      <td>서울특별시 강동구 천호동 450-23 1층</td>
      <td>211492.872614</td>
      <td>448344.663122</td>
    </tr>
    <tr>
      <th>267</th>
      <td>크린나이스 강동점</td>
      <td>서울특별시 강동구 천호동 163-14번지 우정에쉐르 1층 104호</td>
      <td>211707.791367</td>
      <td>448419.291729</td>
    </tr>
    <tr>
      <th>268</th>
      <td>월드크린</td>
      <td>서울특별시 강동구 천호동 414 두산위브106호</td>
      <td>211154.188038</td>
      <td>448580.889486</td>
    </tr>
    <tr>
      <th>269</th>
      <td>크린에이드</td>
      <td>서울특별시 강동구 길동 99-4</td>
      <td>212952.113997</td>
      <td>448698.829639</td>
    </tr>
    <tr>
      <th>270</th>
      <td>명성명품크린</td>
      <td>서울특별시 강동구 명일동 15 삼익그린맨션 2차상가 103호</td>
      <td>213048.692180</td>
      <td>450124.105735</td>
    </tr>
  </tbody>
</table>
<p>269 rows × 4 columns</p>
</div>




```python
# 널값 확인
coin.isnull().sum()
```




    사업장명       0
    지번주소       0
    좌표정보(X)    0
    좌표정보(Y)    0
    dtype: int64




```python
# 자치구 컬럼 만들기
coin_ad_list = coin["지번주소"]
coin_gu = [i.split(" ")[1].strip() for  i in list(coin_ad_list)]

coin["자치구"] =coin_gu
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/4226412618.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      coin["자치구"] =coin_gu
    


```python
# 동 컬럼 만들기
coin_ad_list = coin["지번주소"]
coin_dong = [i.split(" ")[2].strip() for  i in list(coin_ad_list)]

coin["동"] =coin_dong
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/1638802732.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      coin["동"] =coin_dong
    


```python
# 컬럼명 통일을 위한 컬럼명 재설정

coin = coin[["사업장명","자치구", "동", "좌표정보(X)","좌표정보(Y)"]]
coin.columns = ["사업장명","자치구", "동", "X","Y"]
```


```python
coin["업태구분명"] = "코인세탁소"
coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>207768.461525</td>
      <td>450541.996110</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>186184.211193</td>
      <td>444289.107238</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>206917.833161</td>
      <td>457023.152884</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>195766.388348</td>
      <td>444020.397472</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>203058.014515</td>
      <td>460009.769693</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>266</th>
      <td>동명크린</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>211492.872614</td>
      <td>448344.663122</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>267</th>
      <td>크린나이스 강동점</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>211707.791367</td>
      <td>448419.291729</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>268</th>
      <td>월드크린</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>211154.188038</td>
      <td>448580.889486</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>269</th>
      <td>크린에이드</td>
      <td>강동구</td>
      <td>길동</td>
      <td>212952.113997</td>
      <td>448698.829639</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>270</th>
      <td>명성명품크린</td>
      <td>강동구</td>
      <td>명일동</td>
      <td>213048.692180</td>
      <td>450124.105735</td>
      <td>코인세탁소</td>
    </tr>
  </tbody>
</table>
<p>269 rows × 6 columns</p>
</div>



## 약국 정보 전처리


```python
# 페업처리 사업자 제거
pharm = pharm.loc[~pharm["영업상태명"].str.contains("폐업"), :]
pharm.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>도로명우편번호</th>
      <th>사업장명</th>
      <th>최종수정일자</th>
      <th>데이터갱신구분</th>
      <th>데이터갱신일자</th>
      <th>업태구분명</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
      <th>약국영업면적</th>
      <th>지정일자</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3060000</td>
      <td>PHMD120223060034084000006</td>
      <td>20221017</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>13</td>
      <td>영업중</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>2135.0</td>
      <td>연세파란약국</td>
      <td>20221017160535</td>
      <td>I</td>
      <td>2021-10-30 23:09:00.0</td>
      <td>NaN</td>
      <td>206964.460714</td>
      <td>453984.499778</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3240000</td>
      <td>PHMD120223240033084000019</td>
      <td>20221017</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>13</td>
      <td>영업중</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>5264.0</td>
      <td>더조은약국</td>
      <td>20221017134334</td>
      <td>I</td>
      <td>2021-10-30 23:09:00.0</td>
      <td>NaN</td>
      <td>211260.202995</td>
      <td>449774.572648</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 27 columns</p>
</div>




```python
# 사업장명 unique값 확인
# 유니크값이 너무 많아서 확인 불가
pharm["사업장명"].unique()
```




    array(['연세파란약국', '더조은약국', '봄약국', ..., '새사랑약국', '유원당약국', '보문한약국'],
          dtype=object)




```python
# 필요한 컬럼만 추출
pharm = pharm[["사업장명","지번주소","좌표정보(X)","좌표정보(Y)"]].reset_index(drop = True)
pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>연세파란약국</td>
      <td>서울특별시 중랑구 면목동 179-23</td>
      <td>206964.460714</td>
      <td>453984.499778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>더조은약국</td>
      <td>서울특별시 강동구 암사동 501-4 암사동양덱스빌</td>
      <td>211260.202995</td>
      <td>449774.572648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>봄약국</td>
      <td>서울특별시 구로구 오류동 54-4 1층 103호</td>
      <td>186112.599008</td>
      <td>443739.583663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>청담소망약국</td>
      <td>서울특별시 강남구 청담동 44-13</td>
      <td>203971.749611</td>
      <td>446231.554563</td>
    </tr>
    <tr>
      <th>4</th>
      <td>참조은약국</td>
      <td>서울특별시 서대문구 홍은동 9-128</td>
      <td>195392.223419</td>
      <td>455163.943729</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5520</th>
      <td>새사랑약국</td>
      <td>서울특별시 동작구 흑석동 332 이랜드해가든</td>
      <td>196587.030630</td>
      <td>444939.455415</td>
    </tr>
    <tr>
      <th>5521</th>
      <td>맑은수약국</td>
      <td>서울특별시 영등포구 신길동 4491번지 돈보스코청소년센터</td>
      <td>192275.299731</td>
      <td>443891.073399</td>
    </tr>
    <tr>
      <th>5522</th>
      <td>유원당약국</td>
      <td>서울특별시 동대문구 제기동 1109-6</td>
      <td>203264.091526</td>
      <td>453073.831727</td>
    </tr>
    <tr>
      <th>5523</th>
      <td>보문한약국</td>
      <td>서울특별시 동대문구 제기동 1140-32</td>
      <td>203176.142556</td>
      <td>453006.365627</td>
    </tr>
    <tr>
      <th>5524</th>
      <td>온약국</td>
      <td>서울특별시 서초구 양재동 24 스포타임 엘타워</td>
      <td>203028.520902</td>
      <td>442302.889341</td>
    </tr>
  </tbody>
</table>
<p>5525 rows × 4 columns</p>
</div>




```python
# 널값 확인
pharm.isnull().sum()
```




    사업장명         0
    지번주소       345
    좌표정보(X)     95
    좌표정보(Y)     95
    dtype: int64




```python
# 널값 제거
pharm = pharm.dropna()
pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>연세파란약국</td>
      <td>서울특별시 중랑구 면목동 179-23</td>
      <td>206964.460714</td>
      <td>453984.499778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>더조은약국</td>
      <td>서울특별시 강동구 암사동 501-4 암사동양덱스빌</td>
      <td>211260.202995</td>
      <td>449774.572648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>봄약국</td>
      <td>서울특별시 구로구 오류동 54-4 1층 103호</td>
      <td>186112.599008</td>
      <td>443739.583663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>청담소망약국</td>
      <td>서울특별시 강남구 청담동 44-13</td>
      <td>203971.749611</td>
      <td>446231.554563</td>
    </tr>
    <tr>
      <th>4</th>
      <td>참조은약국</td>
      <td>서울특별시 서대문구 홍은동 9-128</td>
      <td>195392.223419</td>
      <td>455163.943729</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5520</th>
      <td>새사랑약국</td>
      <td>서울특별시 동작구 흑석동 332 이랜드해가든</td>
      <td>196587.030630</td>
      <td>444939.455415</td>
    </tr>
    <tr>
      <th>5521</th>
      <td>맑은수약국</td>
      <td>서울특별시 영등포구 신길동 4491번지 돈보스코청소년센터</td>
      <td>192275.299731</td>
      <td>443891.073399</td>
    </tr>
    <tr>
      <th>5522</th>
      <td>유원당약국</td>
      <td>서울특별시 동대문구 제기동 1109-6</td>
      <td>203264.091526</td>
      <td>453073.831727</td>
    </tr>
    <tr>
      <th>5523</th>
      <td>보문한약국</td>
      <td>서울특별시 동대문구 제기동 1140-32</td>
      <td>203176.142556</td>
      <td>453006.365627</td>
    </tr>
    <tr>
      <th>5524</th>
      <td>온약국</td>
      <td>서울특별시 서초구 양재동 24 스포타임 엘타워</td>
      <td>203028.520902</td>
      <td>442302.889341</td>
    </tr>
  </tbody>
</table>
<p>5116 rows × 4 columns</p>
</div>




```python
pharm.isnull().sum()
```




    사업장명       0
    지번주소       0
    좌표정보(X)    0
    좌표정보(Y)    0
    dtype: int64




```python
# 자치구 컬럼 만들기
pharm_ad_list = pharm["지번주소"]
pharm_gu = [i.split(" ")[1].strip() for  i in list(pharm_ad_list)]

pharm["자치구"] =pharm_gu
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/2323115811.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      pharm["자치구"] =pharm_gu
    


```python
# 동 컬럼 만들기
lst = []
pharm_ad_list = list(pharm["지번주소"])
for i in pharm_ad_list :
    if len(i.split(" ")) < 3:
        i = i + " -"
        lst.append(i)
    elif len(i.split(" ")) >= 3:
        lst.append(i)

pharm_dong = [i.split(" ")[2] for  i in lst ]

pharm["동"] = pharm_dong

# 지번주소에 구까지만 나와있는 것이 2개 있다!!
# 그것을 제거해줘야하나?
# => 일단 제거 하는걸로

```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/941346197.py:13: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      pharm["동"] = pharm_dong
    


```python
# 컬럼명 통일을 위한 컬럼명 재설정
pharm = pharm[["사업장명","자치구", "동","좌표정보(X)","좌표정보(Y)"]]
pharm.columns = ["사업장명","자치구", "동", "X","Y"]
```


```python
pharm.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>연세파란약국</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>206964.460714</td>
      <td>453984.499778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>더조은약국</td>
      <td>강동구</td>
      <td>암사동</td>
      <td>211260.202995</td>
      <td>449774.572648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>봄약국</td>
      <td>구로구</td>
      <td>오류동</td>
      <td>186112.599008</td>
      <td>443739.583663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>청담소망약국</td>
      <td>강남구</td>
      <td>청담동</td>
      <td>203971.749611</td>
      <td>446231.554563</td>
    </tr>
    <tr>
      <th>4</th>
      <td>참조은약국</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>195392.223419</td>
      <td>455163.943729</td>
    </tr>
  </tbody>
</table>
</div>




```python
pharm["업태구분명"] = "약국"
pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>연세파란약국</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>206964.460714</td>
      <td>453984.499778</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>1</th>
      <td>더조은약국</td>
      <td>강동구</td>
      <td>암사동</td>
      <td>211260.202995</td>
      <td>449774.572648</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>2</th>
      <td>봄약국</td>
      <td>구로구</td>
      <td>오류동</td>
      <td>186112.599008</td>
      <td>443739.583663</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>3</th>
      <td>청담소망약국</td>
      <td>강남구</td>
      <td>청담동</td>
      <td>203971.749611</td>
      <td>446231.554563</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>4</th>
      <td>참조은약국</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>195392.223419</td>
      <td>455163.943729</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5520</th>
      <td>새사랑약국</td>
      <td>동작구</td>
      <td>흑석동</td>
      <td>196587.030630</td>
      <td>444939.455415</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>5521</th>
      <td>맑은수약국</td>
      <td>영등포구</td>
      <td>신길동</td>
      <td>192275.299731</td>
      <td>443891.073399</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>5522</th>
      <td>유원당약국</td>
      <td>동대문구</td>
      <td>제기동</td>
      <td>203264.091526</td>
      <td>453073.831727</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>5523</th>
      <td>보문한약국</td>
      <td>동대문구</td>
      <td>제기동</td>
      <td>203176.142556</td>
      <td>453006.365627</td>
      <td>약국</td>
    </tr>
    <tr>
      <th>5524</th>
      <td>온약국</td>
      <td>서초구</td>
      <td>양재동</td>
      <td>203028.520902</td>
      <td>442302.889341</td>
      <td>약국</td>
    </tr>
  </tbody>
</table>
<p>5116 rows × 6 columns</p>
</div>



## 편의점 정보 전처리


```python
# 페업처리 사업자 제거
store = store.loc[~store["영업상태명"].str.contains("폐업"), :]
store.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>공장판매직종업원수</th>
      <th>공장생산직종업원수</th>
      <th>건물소유구분명</th>
      <th>보증액</th>
      <th>월세액</th>
      <th>다중이용업소여부</th>
      <th>시설총규모</th>
      <th>전통업소지정번호</th>
      <th>전통업소주된음식</th>
      <th>홈페이지</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3130000</td>
      <td>3130000-104-2022-00101</td>
      <td>20220422</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3120000</td>
      <td>3120000-104-2023-00006</td>
      <td>20230110</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 44 columns</p>
</div>




```python
# 업태구분명 편의점만 추출
store = store.loc[store["업태구분명"].str.contains("편의점"), :]
store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>개방자치단체코드</th>
      <th>관리번호</th>
      <th>인허가일자</th>
      <th>인허가취소일자</th>
      <th>영업상태코드</th>
      <th>영업상태명</th>
      <th>상세영업상태코드</th>
      <th>상세영업상태명</th>
      <th>폐업일자</th>
      <th>휴업시작일자</th>
      <th>...</th>
      <th>공장판매직종업원수</th>
      <th>공장생산직종업원수</th>
      <th>건물소유구분명</th>
      <th>보증액</th>
      <th>월세액</th>
      <th>다중이용업소여부</th>
      <th>시설총규모</th>
      <th>전통업소지정번호</th>
      <th>전통업소주된음식</th>
      <th>홈페이지</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>3230000</td>
      <td>3230000-104-2022-00096</td>
      <td>20220422</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3120000</td>
      <td>3120000-104-2022-00061</td>
      <td>20220422</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3110000</td>
      <td>3110000-104-2022-00074</td>
      <td>20220422</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>3240000</td>
      <td>3240000-104-2023-00028</td>
      <td>2023-02-16</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>40</th>
      <td>3050000</td>
      <td>3050000-104-2022-00047</td>
      <td>20220421</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>121954</th>
      <td>3170000</td>
      <td>3170000-104-2023-00019</td>
      <td>2023-02-13</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>122018</th>
      <td>3230000</td>
      <td>3230000-104-2023-00038</td>
      <td>2023-02-15</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>122020</th>
      <td>3060000</td>
      <td>3060000-104-2023-00016</td>
      <td>2023-02-15</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>122029</th>
      <td>3200000</td>
      <td>3200000-104-2023-00024</td>
      <td>2023-02-15</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>122030</th>
      <td>3200000</td>
      <td>3200000-104-2023-00023</td>
      <td>2023-02-15</td>
      <td>NaN</td>
      <td>1</td>
      <td>영업/정상</td>
      <td>1</td>
      <td>영업</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5872 rows × 44 columns</p>
</div>




```python
# 필요한 컬럼만 추출
store = store[["사업장명","지번주소","좌표정보(X)","좌표정보(Y)","업태구분명"]].reset_index(drop = True)
store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>씨유 송파올림픽점</td>
      <td>서울특별시 송파구 방이동 89 올림픽선수기자촌아파트</td>
      <td>211986.2972</td>
      <td>446156.5298</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>1</th>
      <td>지에스25 홍은중앙로점</td>
      <td>서울특별시 서대문구 홍은동 9-307</td>
      <td>195407.4183</td>
      <td>455381.4803</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>2</th>
      <td>미니스톱 은평우물골점</td>
      <td>서울특별시 은평구 진관동 81 은평뉴타운 우물골</td>
      <td>193202.9119</td>
      <td>459204.6494</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>3</th>
      <td>세븐일레븐 천호이편한점</td>
      <td>서울특별시 강동구 천호동 335-8</td>
      <td>210880.8738</td>
      <td>449088.3890</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>4</th>
      <td>이마트24 장안에이스점</td>
      <td>서울특별시 동대문구 장안동 125-19</td>
      <td>205919.4223</td>
      <td>452644.1369</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5867</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>서울특별시 금천구 시흥동 992-20 웨스트밸리</td>
      <td>191117.3426</td>
      <td>438941.7922</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5868</th>
      <td>씨유 제이제이 가락점</td>
      <td>서울특별시 송파구 가락동 127-20</td>
      <td>211060.8952</td>
      <td>443441.7106</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5869</th>
      <td>씨유 면목대양점</td>
      <td>서울특별시 중랑구 면목동 347-4</td>
      <td>207123.4929</td>
      <td>452675.3514</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5870</th>
      <td>GS25 관악휴먼시아점</td>
      <td>서울특별시 관악구 신림동 1735-3 관악산휴먼시아</td>
      <td>192795.4350</td>
      <td>439787.7156</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5871</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>서울특별시 관악구 봉천동 649-54 전망좋은집</td>
      <td>194287.0913</td>
      <td>442965.1925</td>
      <td>편의점</td>
    </tr>
  </tbody>
</table>
<p>5872 rows × 5 columns</p>
</div>




```python
store.isnull().sum()
```




    사업장명        0
    지번주소        2
    좌표정보(X)    87
    좌표정보(Y)    87
    업태구분명       0
    dtype: int64




```python
# 널값 제거
store = store.dropna()
store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>지번주소</th>
      <th>좌표정보(X)</th>
      <th>좌표정보(Y)</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>씨유 송파올림픽점</td>
      <td>서울특별시 송파구 방이동 89 올림픽선수기자촌아파트</td>
      <td>211986.2972</td>
      <td>446156.5298</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>1</th>
      <td>지에스25 홍은중앙로점</td>
      <td>서울특별시 서대문구 홍은동 9-307</td>
      <td>195407.4183</td>
      <td>455381.4803</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>2</th>
      <td>미니스톱 은평우물골점</td>
      <td>서울특별시 은평구 진관동 81 은평뉴타운 우물골</td>
      <td>193202.9119</td>
      <td>459204.6494</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>3</th>
      <td>세븐일레븐 천호이편한점</td>
      <td>서울특별시 강동구 천호동 335-8</td>
      <td>210880.8738</td>
      <td>449088.3890</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>4</th>
      <td>이마트24 장안에이스점</td>
      <td>서울특별시 동대문구 장안동 125-19</td>
      <td>205919.4223</td>
      <td>452644.1369</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5867</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>서울특별시 금천구 시흥동 992-20 웨스트밸리</td>
      <td>191117.3426</td>
      <td>438941.7922</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5868</th>
      <td>씨유 제이제이 가락점</td>
      <td>서울특별시 송파구 가락동 127-20</td>
      <td>211060.8952</td>
      <td>443441.7106</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5869</th>
      <td>씨유 면목대양점</td>
      <td>서울특별시 중랑구 면목동 347-4</td>
      <td>207123.4929</td>
      <td>452675.3514</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5870</th>
      <td>GS25 관악휴먼시아점</td>
      <td>서울특별시 관악구 신림동 1735-3 관악산휴먼시아</td>
      <td>192795.4350</td>
      <td>439787.7156</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5871</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>서울특별시 관악구 봉천동 649-54 전망좋은집</td>
      <td>194287.0913</td>
      <td>442965.1925</td>
      <td>편의점</td>
    </tr>
  </tbody>
</table>
<p>5783 rows × 5 columns</p>
</div>




```python
store.isnull().sum()
```




    사업장명       0
    지번주소       0
    좌표정보(X)    0
    좌표정보(Y)    0
    업태구분명      0
    dtype: int64




```python
store.columns
```




    Index(['사업장명', '지번주소', '좌표정보(X)', '좌표정보(Y)', '업태구분명'], dtype='object')




```python
# 자치구 컬럼 만들기
store_ad_list = store["지번주소"]
store_gu = [i.split(" ")[1].strip() for  i in list(store_ad_list)]

# store["자치구"] = 
store["자치구"] =store_gu
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/2682467728.py:6: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      store["자치구"] =store_gu
    


```python
# 동 컬럼 만들기
store_ad_list = store["지번주소"]
store_dong = [i.split(" ")[2].strip() for  i in list(store_ad_list)]

store["동"] =store_dong
```

    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/4103312535.py:5: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      store["동"] =store_dong
    


```python
# 컬럼명 통일을 위한 컬럼명 재설정

store = store[['사업장명', '자치구', "동", '좌표정보(X)', '좌표정보(Y)', '업태구분명']]
store.columns = ["사업장명",'자치구', "동", "X","Y", "업태구분명"]
```


```python
store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>씨유 송파올림픽점</td>
      <td>송파구</td>
      <td>방이동</td>
      <td>211986.2972</td>
      <td>446156.5298</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>1</th>
      <td>지에스25 홍은중앙로점</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>195407.4183</td>
      <td>455381.4803</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>2</th>
      <td>미니스톱 은평우물골점</td>
      <td>은평구</td>
      <td>진관동</td>
      <td>193202.9119</td>
      <td>459204.6494</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>3</th>
      <td>세븐일레븐 천호이편한점</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>210880.8738</td>
      <td>449088.3890</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>4</th>
      <td>이마트24 장안에이스점</td>
      <td>동대문구</td>
      <td>장안동</td>
      <td>205919.4223</td>
      <td>452644.1369</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5867</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>191117.3426</td>
      <td>438941.7922</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5868</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>211060.8952</td>
      <td>443441.7106</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5869</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>207123.4929</td>
      <td>452675.3514</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5870</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>192795.4350</td>
      <td>439787.7156</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>5871</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>194287.0913</td>
      <td>442965.1925</td>
      <td>편의점</td>
    </tr>
  </tbody>
</table>
<p>5783 rows × 6 columns</p>
</div>



# 좌표 변경

## 코인세탁소, 약국, 편의점 데이터프레임 병합


```python
df = pd.concat([coin, pharm, store], ignore_index = True )
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>207768.461525</td>
      <td>450541.996110</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>186184.211193</td>
      <td>444289.107238</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>206917.833161</td>
      <td>457023.152884</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>195766.388348</td>
      <td>444020.397472</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>203058.014515</td>
      <td>460009.769693</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11163</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>191117.342600</td>
      <td>438941.792200</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>11164</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>211060.895200</td>
      <td>443441.710600</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>11165</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>207123.492900</td>
      <td>452675.351400</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>11166</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>192795.435000</td>
      <td>439787.715600</td>
      <td>편의점</td>
    </tr>
    <tr>
      <th>11167</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>194287.091300</td>
      <td>442965.192500</td>
      <td>편의점</td>
    </tr>
  </tbody>
</table>
<p>11168 rows × 6 columns</p>
</div>




```python
df.columns = ["사업장명","자치구", "동", "X","Y","업태구분명"]
df.head()
df.columns
```




    Index(['사업장명', '자치구', '동', 'X', 'Y', '업태구분명'], dtype='object')



## TM 좌표계 -> 위경도좌표로 변경


```python
## df의 좌표를 위경도로 바꾼다.
def project_array(coord, p1_type, p2_type):
    """
    좌표계 변환 함수
    - coord: x, y 좌표 정보가 담긴 NumPy Array
    - p1_type: 입력 좌표계 정보 ex) epsg:5179
    - p2_type: 출력 좌표계 정보 ex) epsg:4326
    """
    p1 = pyproj.Proj(init=p1_type)
    p2 = pyproj.Proj(init=p2_type)
    fx, fy = pyproj.transform(p1, p2, coord[:, 0], coord[:, 1])
    return np.dstack([fx, fy])[0]
```


```python
# DataFrame -> NumPy Array 변환
coord = np.array(df[["X", "Y"]])
coord
```




    array([[207768.46152512, 450541.99611009],
           [186184.21119323, 444289.10723828],
           [206917.83316062, 457023.15288352],
           ...,
           [207123.4929    , 452675.3514    ],
           [192795.435     , 439787.7156    ],
           [194287.0913    , 442965.1925    ]])




```python
# 좌표계 정보 설정
p1_type = "epsg:2097"
p2_type = "epsg:4326"

# project_array() 함수 실행
result = project_array(coord, p1_type, p2_type)
result
```

    /Users/o_jungii/opt/anaconda3/lib/python3.9/site-packages/pyproj/crs/crs.py:130: FutureWarning: '+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
      in_crs_string = _prepare_from_proj_string(in_crs_string)
    /Users/o_jungii/opt/anaconda3/lib/python3.9/site-packages/pyproj/crs/crs.py:130: FutureWarning: '+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
      in_crs_string = _prepare_from_proj_string(in_crs_string)
    /var/folders/qm/t7nj8jrn23q1bgrhrz17cyhh0000gn/T/ipykernel_57113/2152348726.py:11: DeprecationWarning: This function is deprecated. See: https://pyproj4.github.io/pyproj/stable/gotchas.html#upgrading-to-pyproj-2-from-pyproj-1
      fx, fy = pyproj.transform(p1, p2, coord[:, 0], coord[:, 1])
    




    array([[127.08581749,  37.55711913],
           [126.84165613,  37.50070887],
           [127.07625113,  37.61552008],
           ...,
           [127.0785386 ,  37.57634556],
           [126.91646659,  37.46022697],
           [126.93330168,  37.48886662]])




```python
df['X'] = result[:, 0]
df['Y'] = result[:, 1]
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>127.085817</td>
      <td>37.557119</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>126.841656</td>
      <td>37.500709</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>127.076251</td>
      <td>37.615520</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>126.950022</td>
      <td>37.498382</td>
      <td>코인세탁소</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>127.032546</td>
      <td>37.642450</td>
      <td>코인세탁소</td>
    </tr>
  </tbody>
</table>
</div>



# 주소 재설정
## 카카오API 활용


```python
# library import
import pandas as pd
import requests 
import sys
import json
import datetime
from tqdm import trange
```


```python
# kakao API 내부 함수
def json_request(url='', encoding='utf-8', success=None, error=lambda e: print('%s : %s' % (e, datetime.now()), file=sys.stderr)):
    headers = {'Authorization': 'KakaoAK {}'.format(APP_KEY)}
    resp = requests.get(url, headers=headers)
    # print('%s : success for request [%s]' % (datetime.now(), url))
    return resp.text


def reverse_geocode(longitude, latitude):
    # 파라미터 최적화하여 url 생성
    url = '%s?x=%s&y=%s' %(URL, longitude, latitude)
    # json request
    try:
        # print('try')
        json_req = json_request(url=url)
        json_data = json.loads(json_req)
        json_doc = json_data.get('documents')[0]
        json_gu = json_doc.get('region_2depth_name') #구단위
        json_dong = json_doc.get('region_3depth_name') #동단위(법정동)
        json_region = json_doc.get('region_type')
    except:
        # print('nan')
        json_gu = 'NaN'
        json_dong = 'NaN'
    return json_gu, json_dong, json_region

 
def get_address(x,y):
    gu = []
    json_gu, json_dong, json_region = reverse_geocode(x, y) 
    gu.append(json_gu)
    return gu # 전처리 함수에서 구단위 리스트 받아서 데이터프레임에 추가


def get_code(x,y):
    dong = []
    json_gu, json_dong, json_region = reverse_geocode(x, y) 
    dong.append(json_dong)
    return dong # 전처리 함수에서 동단위(법정동) 리스트 받아서 데이터프레임에 추가

def get_region(x,y):
    region = []
    json_gu, json_dong, json_region = reverse_geocode(x, y) 
    region.append(json_region)
    return  region
```


```python

# APP_KEY에 본인 REST API KEY 넣기
APP_KEY = '1cefd4d1a5d79437d8e3a50208c819c2'
URL = 'https://dapi.kakao.com/v2/local/geo/coord2regioncode.json'

# 아래의 df 에는 본인이 적용할 dataframe명 변수로 넣으면 됨
# 위도, 경도 매칭 중요 : X값(100대), Y값(30대)
# 함수 적용 전, X, Y 컬럼의 값들 string으로 변환부터 해줘야 적용됨

def get_district(df):
    for i in trange(len(df)): 
        x_crd = float(df.loc[i, ['X']])
        y_crd = float(df.loc[i, ['Y']])
        gu = get_address(x_crd, y_crd)
        dong = get_code(x_crd, y_crd)
        region = get_region(x_crd,y_crd)
        df.loc[i, ['자치구']] = gu
        df.loc[i, ['동']] = dong
        df.loc[i, ['동분류']] = region
    return df
```


```python
df = get_district(df)
df
```

    100%|█████████████████████████████████████| 11168/11168 [56:45<00:00,  3.28it/s]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>127.085817</td>
      <td>37.557119</td>
      <td>코인세탁소</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>126.841656</td>
      <td>37.500709</td>
      <td>코인세탁소</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>127.076251</td>
      <td>37.615520</td>
      <td>코인세탁소</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>126.950022</td>
      <td>37.498382</td>
      <td>코인세탁소</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>127.032546</td>
      <td>37.642450</td>
      <td>코인세탁소</td>
      <td>B</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11163</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>126.897510</td>
      <td>37.452590</td>
      <td>편의점</td>
      <td>B</td>
    </tr>
    <tr>
      <th>11164</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>127.122973</td>
      <td>37.493113</td>
      <td>편의점</td>
      <td>B</td>
    </tr>
    <tr>
      <th>11165</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.078539</td>
      <td>37.576346</td>
      <td>편의점</td>
      <td>B</td>
    </tr>
    <tr>
      <th>11166</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>126.916467</td>
      <td>37.460227</td>
      <td>편의점</td>
      <td>B</td>
    </tr>
    <tr>
      <th>11167</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>126.933302</td>
      <td>37.488867</td>
      <td>편의점</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
<p>11168 rows × 7 columns</p>
</div>



# 전체 데이터 프레임 저장!!!!! 
## df : "df_save.csv"


```python
df["주소"] = df["자치구"] + df["동"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>127.085817</td>
      <td>37.557119</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>광진구중곡동</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>126.841656</td>
      <td>37.500709</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>구로구개봉동</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>127.076251</td>
      <td>37.615520</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>중랑구묵동</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>126.950022</td>
      <td>37.498382</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>동작구상도동</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>127.032546</td>
      <td>37.642450</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>도봉구창동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11163</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>126.897510</td>
      <td>37.452590</td>
      <td>편의점</td>
      <td>B</td>
      <td>금천구시흥동</td>
    </tr>
    <tr>
      <th>11164</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>127.122973</td>
      <td>37.493113</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구가락동</td>
    </tr>
    <tr>
      <th>11165</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.078539</td>
      <td>37.576346</td>
      <td>편의점</td>
      <td>B</td>
      <td>중랑구면목동</td>
    </tr>
    <tr>
      <th>11166</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>126.916467</td>
      <td>37.460227</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구신림동</td>
    </tr>
    <tr>
      <th>11167</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>126.933302</td>
      <td>37.488867</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구봉천동</td>
    </tr>
  </tbody>
</table>
<p>11168 rows × 8 columns</p>
</div>




```python
# 동 갯수 확인 
df.describe(include ="O")  
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>11168</td>
      <td>11168</td>
      <td>11168</td>
      <td>11168</td>
      <td>11168</td>
      <td>11168</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>9399</td>
      <td>32</td>
      <td>404</td>
      <td>3</td>
      <td>1</td>
      <td>407</td>
    </tr>
    <tr>
      <th>top</th>
      <td>봄약국</td>
      <td>강남구</td>
      <td>서초동</td>
      <td>편의점</td>
      <td>B</td>
      <td>서초구서초동</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>20</td>
      <td>994</td>
      <td>304</td>
      <td>5783</td>
      <td>11168</td>
      <td>304</td>
    </tr>
  </tbody>
</table>
</div>




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>127.085817</td>
      <td>37.557119</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>광진구중곡동</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>126.841656</td>
      <td>37.500709</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>구로구개봉동</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>127.076251</td>
      <td>37.615520</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>중랑구묵동</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>126.950022</td>
      <td>37.498382</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>동작구상도동</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>127.032546</td>
      <td>37.642450</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>도봉구창동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11163</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>126.897510</td>
      <td>37.452590</td>
      <td>편의점</td>
      <td>B</td>
      <td>금천구시흥동</td>
    </tr>
    <tr>
      <th>11164</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>127.122973</td>
      <td>37.493113</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구가락동</td>
    </tr>
    <tr>
      <th>11165</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.078539</td>
      <td>37.576346</td>
      <td>편의점</td>
      <td>B</td>
      <td>중랑구면목동</td>
    </tr>
    <tr>
      <th>11166</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>126.916467</td>
      <td>37.460227</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구신림동</td>
    </tr>
    <tr>
      <th>11167</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>126.933302</td>
      <td>37.488867</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구봉천동</td>
    </tr>
  </tbody>
</table>
<p>11168 rows × 8 columns</p>
</div>




```python
# 혹시 모르니 저장
df.to_csv("df_save.csv")
```


```python

```




    사업장명     0
    자치구      0
    동        0
    X        0
    Y        0
    업태구분명    0
    동분류      0
    주소       0
    dtype: int64



# 편의시설별로 데이터프레임 분리
전체 데이터프레임 df에서 각 항목별로 분리
- df_coin
- df_pharm
- df_store

## df_coin


```python
df_coin = df.loc[df["업태구분명"] == "코인세탁소", :]
df_coin.drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>마마운동화이불빨래방 중곡점</td>
      <td>광진구</td>
      <td>중곡동</td>
      <td>127.085817</td>
      <td>37.557119</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>광진구중곡동</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그린셀프크리닝</td>
      <td>구로구</td>
      <td>개봉동</td>
      <td>126.841656</td>
      <td>37.500709</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>구로구개봉동</td>
    </tr>
    <tr>
      <th>2</th>
      <td>마마운동화빨래방</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>127.076251</td>
      <td>37.615520</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>중랑구묵동</td>
    </tr>
    <tr>
      <th>3</th>
      <td>아이크린세탁전문점</td>
      <td>동작구</td>
      <td>상도동</td>
      <td>126.950022</td>
      <td>37.498382</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>동작구상도동</td>
    </tr>
    <tr>
      <th>4</th>
      <td>주식회사 크린토피아 도봉</td>
      <td>도봉구</td>
      <td>창동</td>
      <td>127.032546</td>
      <td>37.642450</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>도봉구창동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>264</th>
      <td>동명크린</td>
      <td>강동구</td>
      <td>성내동</td>
      <td>127.127934</td>
      <td>37.537283</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>강동구성내동</td>
    </tr>
    <tr>
      <th>265</th>
      <td>크린나이스 강동점</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>127.130367</td>
      <td>37.537952</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>강동구천호동</td>
    </tr>
    <tr>
      <th>266</th>
      <td>월드크린</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>127.124106</td>
      <td>37.539415</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>강동구천호동</td>
    </tr>
    <tr>
      <th>267</th>
      <td>크린에이드</td>
      <td>강동구</td>
      <td>길동</td>
      <td>127.144451</td>
      <td>37.540455</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>강동구길동</td>
    </tr>
    <tr>
      <th>268</th>
      <td>명성명품크린</td>
      <td>강동구</td>
      <td>명일동</td>
      <td>127.145569</td>
      <td>37.553295</td>
      <td>코인세탁소</td>
      <td>B</td>
      <td>강동구명일동</td>
    </tr>
  </tbody>
</table>
<p>269 rows × 8 columns</p>
</div>



## df_pharm


```python
df_pharm = df.loc[df["업태구분명"] == "약국", :]
df_pharm = df_pharm.drop_duplicates()
df_pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>269</th>
      <td>연세파란약국</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.076751</td>
      <td>37.588142</td>
      <td>약국</td>
      <td>B</td>
      <td>중랑구면목동</td>
    </tr>
    <tr>
      <th>270</th>
      <td>더조은약국</td>
      <td>강동구</td>
      <td>암사동</td>
      <td>127.125323</td>
      <td>37.550169</td>
      <td>약국</td>
      <td>B</td>
      <td>강동구암사동</td>
    </tr>
    <tr>
      <th>271</th>
      <td>봄약국</td>
      <td>구로구</td>
      <td>오류동</td>
      <td>126.840857</td>
      <td>37.495757</td>
      <td>약국</td>
      <td>B</td>
      <td>구로구오류동</td>
    </tr>
    <tr>
      <th>272</th>
      <td>청담소망약국</td>
      <td>강남구</td>
      <td>청담동</td>
      <td>127.042825</td>
      <td>37.518306</td>
      <td>약국</td>
      <td>B</td>
      <td>강남구청담동</td>
    </tr>
    <tr>
      <th>273</th>
      <td>참조은약국</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>126.945720</td>
      <td>37.598783</td>
      <td>약국</td>
      <td>B</td>
      <td>서대문구홍은동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5380</th>
      <td>새사랑약국</td>
      <td>동작구</td>
      <td>흑석동</td>
      <td>126.959298</td>
      <td>37.506666</td>
      <td>약국</td>
      <td>B</td>
      <td>동작구흑석동</td>
    </tr>
    <tr>
      <th>5381</th>
      <td>맑은수약국</td>
      <td>영등포구</td>
      <td>신길동</td>
      <td>126.910544</td>
      <td>37.497194</td>
      <td>약국</td>
      <td>B</td>
      <td>영등포구신길동</td>
    </tr>
    <tr>
      <th>5382</th>
      <td>유원당약국</td>
      <td>동대문구</td>
      <td>제기동</td>
      <td>127.034850</td>
      <td>37.579957</td>
      <td>약국</td>
      <td>B</td>
      <td>동대문구제기동</td>
    </tr>
    <tr>
      <th>5383</th>
      <td>보문한약국</td>
      <td>동대문구</td>
      <td>제기동</td>
      <td>127.033854</td>
      <td>37.579350</td>
      <td>약국</td>
      <td>B</td>
      <td>동대문구제기동</td>
    </tr>
    <tr>
      <th>5384</th>
      <td>온약국</td>
      <td>서초구</td>
      <td>서초동</td>
      <td>127.032140</td>
      <td>37.482913</td>
      <td>약국</td>
      <td>B</td>
      <td>서초구서초동</td>
    </tr>
  </tbody>
</table>
<p>5113 rows × 8 columns</p>
</div>



## df_store


```python
df_store = df.loc[df["업태구분명"] == "편의점", :]
df_store = df_store.drop_duplicates()
df_store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5385</th>
      <td>씨유 송파올림픽점</td>
      <td>송파구</td>
      <td>방이동</td>
      <td>127.133482</td>
      <td>37.517562</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구방이동</td>
    </tr>
    <tr>
      <th>5386</th>
      <td>지에스25 홍은중앙로점</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>126.945891</td>
      <td>37.600743</td>
      <td>편의점</td>
      <td>B</td>
      <td>서대문구홍은동</td>
    </tr>
    <tr>
      <th>5387</th>
      <td>미니스톱 은평우물골점</td>
      <td>은평구</td>
      <td>진관동</td>
      <td>126.920891</td>
      <td>37.635175</td>
      <td>편의점</td>
      <td>B</td>
      <td>은평구진관동</td>
    </tr>
    <tr>
      <th>5388</th>
      <td>세븐일레븐 천호이편한점</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>127.121021</td>
      <td>37.543991</td>
      <td>편의점</td>
      <td>B</td>
      <td>강동구천호동</td>
    </tr>
    <tr>
      <th>5389</th>
      <td>이마트24 장안에이스점</td>
      <td>동대문구</td>
      <td>답십리동</td>
      <td>127.064908</td>
      <td>37.576073</td>
      <td>편의점</td>
      <td>B</td>
      <td>동대문구답십리동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11163</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>126.897510</td>
      <td>37.452590</td>
      <td>편의점</td>
      <td>B</td>
      <td>금천구시흥동</td>
    </tr>
    <tr>
      <th>11164</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>127.122973</td>
      <td>37.493113</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구가락동</td>
    </tr>
    <tr>
      <th>11165</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.078539</td>
      <td>37.576346</td>
      <td>편의점</td>
      <td>B</td>
      <td>중랑구면목동</td>
    </tr>
    <tr>
      <th>11166</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>126.916467</td>
      <td>37.460227</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구신림동</td>
    </tr>
    <tr>
      <th>11167</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>126.933302</td>
      <td>37.488867</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구봉천동</td>
    </tr>
  </tbody>
</table>
<p>5781 rows × 8 columns</p>
</div>



# 합계 포함 df 만들기
주소별 합계 df
- df_s_coin
- df_s_pharm
- df_s_store

## df_s_coin


```python
## 다현님처럼 동별 합계와 좌표 평균
# 코인세탁소 합계
df_s_coin = df.loc[df["업태구분명"] == "코인세탁소", :]
df_s_coin = df_s_coin.groupby(["주소"])["업태구분명"].count()
df_s_coin = pd.DataFrame(df_s_coin).reset_index()
df_s_coin = df_s_coin.rename(columns = {"업태구분명" : "합계"})

df_s_coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주소</th>
      <th>합계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구논현동</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강남구대치동</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강남구도곡동</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강남구삼성동</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>강남구압구정동</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>중랑구면목동</td>
      <td>4</td>
    </tr>
    <tr>
      <th>127</th>
      <td>중랑구묵동</td>
      <td>1</td>
    </tr>
    <tr>
      <th>128</th>
      <td>중랑구상봉동</td>
      <td>1</td>
    </tr>
    <tr>
      <th>129</th>
      <td>중랑구신내동</td>
      <td>2</td>
    </tr>
    <tr>
      <th>130</th>
      <td>중랑구중화동</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 2 columns</p>
</div>



## df_s_pharm


```python
# 약국 합계
df_s_pharm = df.loc[df["업태구분명"] == "약국", :]
df_s_pharm = df_s_pharm.groupby(["주소"])["업태구분명"].count()
df_s_pharm = pd.DataFrame(df_s_pharm).reset_index()
df_s_pharm = df_s_pharm.rename(columns = {"업태구분명" : "합계"})
df_s_pharm.head(2)
df_s_pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주소</th>
      <th>합계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구개포동</td>
      <td>23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강남구논현동</td>
      <td>57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강남구대치동</td>
      <td>33</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강남구도곡동</td>
      <td>14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>강남구삼성동</td>
      <td>33</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>341</th>
      <td>중랑구면목동</td>
      <td>64</td>
    </tr>
    <tr>
      <th>342</th>
      <td>중랑구묵동</td>
      <td>22</td>
    </tr>
    <tr>
      <th>343</th>
      <td>중랑구상봉동</td>
      <td>32</td>
    </tr>
    <tr>
      <th>344</th>
      <td>중랑구신내동</td>
      <td>21</td>
    </tr>
    <tr>
      <th>345</th>
      <td>중랑구중화동</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>346 rows × 2 columns</p>
</div>



## df_s_store


```python
# 편의점 합계
df_s_store = df.loc[df["업태구분명"] == "편의점", :]
df_s_store = df_s_store.groupby(["주소"])["업태구분명"].count()
df_s_store = pd.DataFrame(df_s_store).reset_index()
df_s_store = df_s_store.rename(columns = {"업태구분명" : "합계"})
df_s_store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주소</th>
      <th>합계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남구개포동</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강남구논현동</td>
      <td>94</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강남구대치동</td>
      <td>58</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강남구도곡동</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>강남구삼성동</td>
      <td>64</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>374</th>
      <td>중랑구면목동</td>
      <td>86</td>
    </tr>
    <tr>
      <th>375</th>
      <td>중랑구묵동</td>
      <td>23</td>
    </tr>
    <tr>
      <th>376</th>
      <td>중랑구상봉동</td>
      <td>37</td>
    </tr>
    <tr>
      <th>377</th>
      <td>중랑구신내동</td>
      <td>21</td>
    </tr>
    <tr>
      <th>378</th>
      <td>중랑구중화동</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
<p>379 rows × 2 columns</p>
</div>



# 법정코드 파일 불러오기


```python
# 법정코드 불러온 파일
code = pd.read_csv('eStatutory_dong_code.csv', index_col = 0)
code = code [["법정동코드", "주소"]]
code.drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>법정동코드</th>
      <th>주소</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11110101</td>
      <td>종로구청운동</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11110102</td>
      <td>종로구신교동</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11110103</td>
      <td>종로구궁정동</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11110104</td>
      <td>종로구효자동</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11110105</td>
      <td>종로구창성동</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>461</th>
      <td>11740106</td>
      <td>강동구둔촌동</td>
    </tr>
    <tr>
      <th>462</th>
      <td>11740107</td>
      <td>강동구암사동</td>
    </tr>
    <tr>
      <th>463</th>
      <td>11740108</td>
      <td>강동구성내동</td>
    </tr>
    <tr>
      <th>464</th>
      <td>11740109</td>
      <td>강동구천호동</td>
    </tr>
    <tr>
      <th>465</th>
      <td>11740110</td>
      <td>강동구강일동</td>
    </tr>
  </tbody>
</table>
<p>467 rows × 2 columns</p>
</div>




```python
code.isnull().sum()
```




    법정동코드    0
    주소       0
    dtype: int64



## df_c_coin


```python
df_c_coin = pd.merge(df_coin, code, how = "left", on = "주소") 
df_c_coin.isnull().sum()
```




    사업장명     0
    자치구      0
    동        0
    X        0
    Y        0
    업태구분명    0
    동분류      0
    주소       0
    법정동코드    0
    dtype: int64



## df_c_pharm


```python
df_c_pharm = pd.merge(df_pharm, code, how = "left", on = "주소") 
df_c_pharm = df_c_pharm.dropna()
df_c_pharm.isnull().sum()
```




    사업장명     0
    자치구      0
    동        0
    X        0
    Y        0
    업태구분명    0
    동분류      0
    주소       0
    법정동코드    0
    dtype: int64




```python
df_c_pharm.loc[df_c_pharm["법정동코드"].isnull() == True, :]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
      <th>법정동코드</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



## df_c_store


```python
df_c_store = pd.merge(df_store, code, how = "left", on = "주소") 
df_c_store = df_c_store.dropna()
df_c_store.isnull().sum()
```




    사업장명     0
    자치구      0
    동        0
    X        0
    Y        0
    업태구분명    0
    동분류      0
    주소       0
    법정동코드    0
    dtype: int64



# 동당 면적 불러오기


```python
# 법정코드 불러온 파일
aa = pd.read_excel('code_new.xlsx', index_col =0, header = None)

aa = aa.iloc[3:, 0:3]
aa["주소"] = aa[1] + aa[2]
aa = aa.loc[~aa[2].str.contains("소계"), :]
aa = aa[["주소",3]]
aa.columns = ["주소", "면적"]
aa = aa.reset_index(drop =True)
aa
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주소</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>종로구청운동</td>
      <td>797032.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>종로구신교동</td>
      <td>99144</td>
    </tr>
    <tr>
      <th>2</th>
      <td>종로구궁정동</td>
      <td>73042.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>종로구효자동</td>
      <td>59135.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>종로구창성동</td>
      <td>59706.1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>462</th>
      <td>강동구둔촌동</td>
      <td>2461511.8</td>
    </tr>
    <tr>
      <th>463</th>
      <td>강동구암사동</td>
      <td>4711364.2</td>
    </tr>
    <tr>
      <th>464</th>
      <td>강동구성내동</td>
      <td>1958987.6</td>
    </tr>
    <tr>
      <th>465</th>
      <td>강동구천호동</td>
      <td>3065547.9</td>
    </tr>
    <tr>
      <th>466</th>
      <td>강동구강일동</td>
      <td>2267204.2</td>
    </tr>
  </tbody>
</table>
<p>467 rows × 2 columns</p>
</div>



## 데이터프레임 + 면적

### df_a_coin


```python
# df_a_coin
df_a_coin = pd.merge(df_c_coin, aa, how = "left", on = "주소")
```

### df_a_pharm


```python
df_a_pharm = pd.merge(df_c_pharm, aa, how = "left", on = "주소")
```

### df_a_store


```python
df_a_store=pd.merge(df_c_store, aa, how = "left", on = "주소")
df_a_store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사업장명</th>
      <th>자치구</th>
      <th>동</th>
      <th>X</th>
      <th>Y</th>
      <th>업태구분명</th>
      <th>동분류</th>
      <th>주소</th>
      <th>법정동코드</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>씨유 송파올림픽점</td>
      <td>송파구</td>
      <td>방이동</td>
      <td>127.133482</td>
      <td>37.517562</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구방이동</td>
      <td>11710111.0</td>
      <td>4468042.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>지에스25 홍은중앙로점</td>
      <td>서대문구</td>
      <td>홍은동</td>
      <td>126.945891</td>
      <td>37.600743</td>
      <td>편의점</td>
      <td>B</td>
      <td>서대문구홍은동</td>
      <td>11410118.0</td>
      <td>3645684.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>미니스톱 은평우물골점</td>
      <td>은평구</td>
      <td>진관동</td>
      <td>126.920891</td>
      <td>37.635175</td>
      <td>편의점</td>
      <td>B</td>
      <td>은평구진관동</td>
      <td>11380114.0</td>
      <td>11533421.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>세븐일레븐 천호이편한점</td>
      <td>강동구</td>
      <td>천호동</td>
      <td>127.121021</td>
      <td>37.543991</td>
      <td>편의점</td>
      <td>B</td>
      <td>강동구천호동</td>
      <td>11740109.0</td>
      <td>3065547.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>이마트24 장안에이스점</td>
      <td>동대문구</td>
      <td>답십리동</td>
      <td>127.064908</td>
      <td>37.576073</td>
      <td>편의점</td>
      <td>B</td>
      <td>동대문구답십리동</td>
      <td>11230105.0</td>
      <td>1659884.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5748</th>
      <td>지에스(GS25) 시흥웨스트점</td>
      <td>금천구</td>
      <td>시흥동</td>
      <td>126.897510</td>
      <td>37.452590</td>
      <td>편의점</td>
      <td>B</td>
      <td>금천구시흥동</td>
      <td>11545103.0</td>
      <td>6295568</td>
    </tr>
    <tr>
      <th>5749</th>
      <td>씨유 제이제이 가락점</td>
      <td>송파구</td>
      <td>가락동</td>
      <td>127.122973</td>
      <td>37.493113</td>
      <td>편의점</td>
      <td>B</td>
      <td>송파구가락동</td>
      <td>11710107.0</td>
      <td>3431874.4</td>
    </tr>
    <tr>
      <th>5750</th>
      <td>씨유 면목대양점</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>127.078539</td>
      <td>37.576346</td>
      <td>편의점</td>
      <td>B</td>
      <td>중랑구면목동</td>
      <td>11260101.0</td>
      <td>6028753.1</td>
    </tr>
    <tr>
      <th>5751</th>
      <td>GS25 관악휴먼시아점</td>
      <td>관악구</td>
      <td>신림동</td>
      <td>126.916467</td>
      <td>37.460227</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구신림동</td>
      <td>11620102.0</td>
      <td>18137675.7</td>
    </tr>
    <tr>
      <th>5752</th>
      <td>지에스(GS25)봉천동신점</td>
      <td>관악구</td>
      <td>봉천동</td>
      <td>126.933302</td>
      <td>37.488867</td>
      <td>편의점</td>
      <td>B</td>
      <td>관악구봉천동</td>
      <td>11620101.0</td>
      <td>8162555.4</td>
    </tr>
  </tbody>
</table>
<p>5753 rows × 10 columns</p>
</div>



# 종합 데이트프레임 만들기 (동별로 묶어서)
- 구분/ 법정동코드  / 자치구 / 동 / 합계/점수
- df_c_coin, df_pharm, df_store, 
- df_s_??  + 각 데이터프레임 left merge

## 법정코드 합친 코인세탁소 데이터프레임 : df_t_coin


```python
# 코인세탁소 종합 병합용 데이터프레임
df_a_coin = df_a_coin[["업태구분명", "법정동코드", "자치구", "동", "면적", "주소"]]
df_t_coin = pd.merge(df_s_coin, df_a_coin, how = "left", on ="주소")

df_t_coin = df_t_coin[["업태구분명", "법정동코드", "자치구", "동", "합계", "면적"]]
df_t_coin.columns = ["구분", "법정동코드", "자치구", "동", "합계" , "면적" ]
df_t_coin = df_t_coin.drop_duplicates().reset_index(drop=True)
df_t_coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3</td>
      <td>2717301</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2</td>
      <td>3791374.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2</td>
      <td>2038231.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2</td>
      <td>3193589.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1</td>
      <td>2685131.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>코인세탁소</td>
      <td>11260101</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>4</td>
      <td>6028753.1</td>
    </tr>
    <tr>
      <th>127</th>
      <td>코인세탁소</td>
      <td>11260104</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>1</td>
      <td>1901417.9</td>
    </tr>
    <tr>
      <th>128</th>
      <td>코인세탁소</td>
      <td>11260102</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>1</td>
      <td>1528221.3</td>
    </tr>
    <tr>
      <th>129</th>
      <td>코인세탁소</td>
      <td>11260106</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>2</td>
      <td>3510782.5</td>
    </tr>
    <tr>
      <th>130</th>
      <td>코인세탁소</td>
      <td>11260103</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>1</td>
      <td>1654928.1</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 6 columns</p>
</div>



## 법정코드 합친 코인세탁소 데이터프레임 : df_t_pharm


```python
# 약국 종합 병합용 데이터프레임
# 코인세탁소 종합 병합용 데이터프레임
df_a_pharm = df_a_pharm[["업태구분명", "법정동코드", "자치구", "동", "면적", "주소"]]
df_t_pharm = pd.merge(df_s_pharm, df_a_pharm, how = "left", on ="주소")

df_t_pharm = df_t_pharm[["업태구분명", "법정동코드", "자치구", "동", "합계", "면적"]]
df_t_pharm.columns = ["구분", "법정동코드", "자치구", "동", "합계" , "면적" ]
df_t_pharm = df_t_pharm.drop_duplicates().reset_index(drop=True)
df_t_pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>약국</td>
      <td>11680103.0</td>
      <td>강남구</td>
      <td>개포동</td>
      <td>23</td>
      <td>5424693.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>약국</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>57</td>
      <td>2717301</td>
    </tr>
    <tr>
      <th>2</th>
      <td>약국</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>33</td>
      <td>3791374.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>약국</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>14</td>
      <td>2038231.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>약국</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>33</td>
      <td>3193589.8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>336</th>
      <td>약국</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>64</td>
      <td>6028753.1</td>
    </tr>
    <tr>
      <th>337</th>
      <td>약국</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>22</td>
      <td>1901417.9</td>
    </tr>
    <tr>
      <th>338</th>
      <td>약국</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>32</td>
      <td>1528221.3</td>
    </tr>
    <tr>
      <th>339</th>
      <td>약국</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21</td>
      <td>3510782.5</td>
    </tr>
    <tr>
      <th>340</th>
      <td>약국</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>24</td>
      <td>1654928.1</td>
    </tr>
  </tbody>
</table>
<p>341 rows × 6 columns</p>
</div>



## 법정코드 합친 코인세탁소 데이터프레임 : df_t_store


```python
# 편의점 종합 병합용 데이터프레임
df_a_store = df_a_store[["업태구분명", "법정동코드", "자치구", "동", "면적", "주소"]]
df_t_store = pd.merge(df_s_store, df_a_store, how = "left", on ="주소")

df_t_store = df_t_store[["업태구분명", "법정동코드", "자치구", "동", "합계", "면적"]]
df_t_store.columns = ["구분", "법정동코드", "자치구", "동", "합계" , "면적" ]
df_t_store = df_t_store.drop_duplicates().reset_index(drop=True)
df_t_store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>편의점</td>
      <td>11680103.0</td>
      <td>강남구</td>
      <td>개포동</td>
      <td>20</td>
      <td>5424693.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>편의점</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>94</td>
      <td>2717301</td>
    </tr>
    <tr>
      <th>2</th>
      <td>편의점</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>58</td>
      <td>3791374.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>편의점</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>16</td>
      <td>2038231.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>편의점</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>64</td>
      <td>3193589.8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>364</th>
      <td>편의점</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>86</td>
      <td>6028753.1</td>
    </tr>
    <tr>
      <th>365</th>
      <td>편의점</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>23</td>
      <td>1901417.9</td>
    </tr>
    <tr>
      <th>366</th>
      <td>편의점</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>37</td>
      <td>1528221.3</td>
    </tr>
    <tr>
      <th>367</th>
      <td>편의점</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21</td>
      <td>3510782.5</td>
    </tr>
    <tr>
      <th>368</th>
      <td>편의점</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>32</td>
      <td>1654928.1</td>
    </tr>
  </tbody>
</table>
<p>369 rows × 6 columns</p>
</div>



## 종합 전체 데이터프레임 : df_t


```python
df_t = pd.concat([df_t_coin, df_t_pharm, df_t_store], ignore_index = True)
df_t
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3</td>
      <td>2717301</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2</td>
      <td>3791374.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2</td>
      <td>2038231.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2</td>
      <td>3193589.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110.0</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1</td>
      <td>2685131.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>836</th>
      <td>편의점</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>86</td>
      <td>6028753.1</td>
    </tr>
    <tr>
      <th>837</th>
      <td>편의점</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>23</td>
      <td>1901417.9</td>
    </tr>
    <tr>
      <th>838</th>
      <td>편의점</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>37</td>
      <td>1528221.3</td>
    </tr>
    <tr>
      <th>839</th>
      <td>편의점</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21</td>
      <td>3510782.5</td>
    </tr>
    <tr>
      <th>840</th>
      <td>편의점</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>32</td>
      <td>1654928.1</td>
    </tr>
  </tbody>
</table>
<p>841 rows × 6 columns</p>
</div>



# 합계당 면적 컬럼 추가


```python
df_t["합계"] = df_t["합계"].astype(float)
df_t["면적"] = df_t["면적"].astype(float)

df_t["합계당면적"] = df_t["면적"] / df_t["합계"]
df_t = df_t.dropna()
df_t
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
      <th>합계당면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3.0</td>
      <td>2717301.0</td>
      <td>9.057670e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2.0</td>
      <td>3791374.3</td>
      <td>1.895687e+06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2.0</td>
      <td>2038231.2</td>
      <td>1.019116e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2.0</td>
      <td>3193589.8</td>
      <td>1.596795e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110.0</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1.0</td>
      <td>2685131.5</td>
      <td>2.685132e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>836</th>
      <td>편의점</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>86.0</td>
      <td>6028753.1</td>
      <td>7.010178e+04</td>
    </tr>
    <tr>
      <th>837</th>
      <td>편의점</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>23.0</td>
      <td>1901417.9</td>
      <td>8.267034e+04</td>
    </tr>
    <tr>
      <th>838</th>
      <td>편의점</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>37.0</td>
      <td>1528221.3</td>
      <td>4.130328e+04</td>
    </tr>
    <tr>
      <th>839</th>
      <td>편의점</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21.0</td>
      <td>3510782.5</td>
      <td>1.671801e+05</td>
    </tr>
    <tr>
      <th>840</th>
      <td>편의점</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>32.0</td>
      <td>1654928.1</td>
      <td>5.171650e+04</td>
    </tr>
  </tbody>
</table>
<p>836 rows × 7 columns</p>
</div>




```python
df_t.isnull().sum()
```




    구분       0
    법정동코드    0
    자치구      0
    동        0
    합계       0
    면적       0
    합계당면적    0
    dtype: int64



# 편의시설별 점수 매기기
- 합계당 면적을 이용
- 합계당 면적이 작을수록 점수를 높게 부여
- 점수는 10개구간으로 나누어 100점 만점

## 데이터프레임 구분 / 전체 -> 구분별


```python
## 데이터프레임 구분

df_fac_coin =df_t.loc[df_t["구분"].str.contains("코인세탁소"), :].reset_index(drop =True)
df_fac_coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
      <th>합계당면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3.0</td>
      <td>2717301.0</td>
      <td>905767.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2.0</td>
      <td>3791374.3</td>
      <td>1895687.150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2.0</td>
      <td>2038231.2</td>
      <td>1019115.600</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2.0</td>
      <td>3193589.8</td>
      <td>1596794.900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110.0</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1.0</td>
      <td>2685131.5</td>
      <td>2685131.500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>코인세탁소</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>4.0</td>
      <td>6028753.1</td>
      <td>1507188.275</td>
    </tr>
    <tr>
      <th>127</th>
      <td>코인세탁소</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>1.0</td>
      <td>1901417.9</td>
      <td>1901417.900</td>
    </tr>
    <tr>
      <th>128</th>
      <td>코인세탁소</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>1.0</td>
      <td>1528221.3</td>
      <td>1528221.300</td>
    </tr>
    <tr>
      <th>129</th>
      <td>코인세탁소</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>2.0</td>
      <td>3510782.5</td>
      <td>1755391.250</td>
    </tr>
    <tr>
      <th>130</th>
      <td>코인세탁소</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>1.0</td>
      <td>1654928.1</td>
      <td>1654928.100</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 7 columns</p>
</div>




```python
df_fac_pharm = df_t.loc[df_t["구분"].str.contains("약국"), :].reset_index(drop =True)
df_fac_pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
      <th>합계당면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>약국</td>
      <td>11680103.0</td>
      <td>강남구</td>
      <td>개포동</td>
      <td>23.0</td>
      <td>5424693.6</td>
      <td>235856.243478</td>
    </tr>
    <tr>
      <th>1</th>
      <td>약국</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>57.0</td>
      <td>2717301.0</td>
      <td>47671.947368</td>
    </tr>
    <tr>
      <th>2</th>
      <td>약국</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>33.0</td>
      <td>3791374.3</td>
      <td>114890.130303</td>
    </tr>
    <tr>
      <th>3</th>
      <td>약국</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>14.0</td>
      <td>2038231.2</td>
      <td>145587.942857</td>
    </tr>
    <tr>
      <th>4</th>
      <td>약국</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>33.0</td>
      <td>3193589.8</td>
      <td>96775.448485</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>334</th>
      <td>약국</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>64.0</td>
      <td>6028753.1</td>
      <td>94199.267187</td>
    </tr>
    <tr>
      <th>335</th>
      <td>약국</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>22.0</td>
      <td>1901417.9</td>
      <td>86428.086364</td>
    </tr>
    <tr>
      <th>336</th>
      <td>약국</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>32.0</td>
      <td>1528221.3</td>
      <td>47756.915625</td>
    </tr>
    <tr>
      <th>337</th>
      <td>약국</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21.0</td>
      <td>3510782.5</td>
      <td>167180.119048</td>
    </tr>
    <tr>
      <th>338</th>
      <td>약국</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>24.0</td>
      <td>1654928.1</td>
      <td>68955.337500</td>
    </tr>
  </tbody>
</table>
<p>339 rows × 7 columns</p>
</div>




```python
df_fac_store = df_t.loc[df_t["구분"].str.contains("편의점"), :].reset_index(drop =True)
df_fac_store
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>면적</th>
      <th>합계당면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>편의점</td>
      <td>11680103.0</td>
      <td>강남구</td>
      <td>개포동</td>
      <td>20.0</td>
      <td>5424693.6</td>
      <td>271234.680000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>편의점</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>94.0</td>
      <td>2717301.0</td>
      <td>28907.457447</td>
    </tr>
    <tr>
      <th>2</th>
      <td>편의점</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>58.0</td>
      <td>3791374.3</td>
      <td>65368.522414</td>
    </tr>
    <tr>
      <th>3</th>
      <td>편의점</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>16.0</td>
      <td>2038231.2</td>
      <td>127389.450000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>편의점</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>64.0</td>
      <td>3193589.8</td>
      <td>49899.840625</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>361</th>
      <td>편의점</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>86.0</td>
      <td>6028753.1</td>
      <td>70101.780233</td>
    </tr>
    <tr>
      <th>362</th>
      <td>편의점</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>23.0</td>
      <td>1901417.9</td>
      <td>82670.343478</td>
    </tr>
    <tr>
      <th>363</th>
      <td>편의점</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>37.0</td>
      <td>1528221.3</td>
      <td>41303.278378</td>
    </tr>
    <tr>
      <th>364</th>
      <td>편의점</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21.0</td>
      <td>3510782.5</td>
      <td>167180.119048</td>
    </tr>
    <tr>
      <th>365</th>
      <td>편의점</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>32.0</td>
      <td>1654928.1</td>
      <td>51716.503125</td>
    </tr>
  </tbody>
</table>
<p>366 rows × 7 columns</p>
</div>




```python
df_fac_store.isnull().sum()
```




    구분       0
    법정동코드    0
    자치구      0
    동        0
    합계       0
    면적       0
    합계당면적    0
    dtype: int64



# 편의시설별 점수 추가

## 최종 코인세탁소 df : df_fac_coin


```python
# 코인세탁
grades = [] 
for row in df_fac_coin["합계당면적"] : 
    if row > df_fac_coin['합계당면적'].quantile(0.9):
        grades.append(10) 
    elif row > df_fac_coin['합계당면적'].quantile(0.8):
        grades.append(20)
    elif row > df_fac_coin['합계당면적'].quantile(0.7):
        grades.append(30)
    elif row > df_fac_coin['합계당면적'].quantile(0.6):
        grades.append(40)
    elif row > df_fac_coin['합계당면적'].quantile(0.5):
        grades.append(50)
    elif row > df_fac_coin['합계당면적'].quantile(0.4):
        grades.append(60)
    elif row > df_fac_coin['합계당면적'].quantile(0.3):
        grades.append(70)
    elif row > df_fac_coin['합계당면적'].quantile(0.2):
        grades.append(80)
    elif row > df_fac_coin['합계당면적'].quantile(0.1):
        grades.append(90)

    else :
        grades.append(100)
        
df_fac_coin['점수'] = grades 
```


```python
df_fac_coin = df_fac_coin.reset_index(drop=True)
df_fac_coin = df_fac_coin[["구분", "법정동코드", "자치구", "동", "합계", "점수"]]
df_fac_coin.to_csv("df_fac_coin.csv")
df_fac_coin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110.0</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1.0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>코인세탁소</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>4.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>127</th>
      <td>코인세탁소</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>1.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>128</th>
      <td>코인세탁소</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>1.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>129</th>
      <td>코인세탁소</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>2.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>130</th>
      <td>코인세탁소</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>1.0</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 6 columns</p>
</div>



## 최종 약국 df : df_fac_pharm


```python
# 약국
grades = [] 
for row in df_fac_pharm["합계당면적"] : 
    if row > df_fac_pharm['합계당면적'].quantile(0.9):
        grades.append(10) 
    elif row > df_fac_pharm['합계당면적'].quantile(0.8):
        grades.append(20)
    elif row > df_fac_pharm['합계당면적'].quantile(0.7):
        grades.append(30)
    elif row > df_fac_pharm['합계당면적'].quantile(0.6):
        grades.append(40)
    elif row > df_fac_pharm['합계당면적'].quantile(0.5):
        grades.append(50)
    elif row > df_fac_pharm['합계당면적'].quantile(0.4):
        grades.append(60)
    elif row > df_fac_pharm['합계당면적'].quantile(0.3):
        grades.append(70)
    elif row > df_fac_pharm['합계당면적'].quantile(0.2):
        grades.append(80)
    elif row > df_fac_pharm['합계당면적'].quantile(0.1):
        grades.append(90)

    else :
        grades.append(100)
        
df_fac_pharm['점수'] = grades 
df_fac_pharm = df_fac_pharm[["구분", "법정동코드", "자치구", "동", "합계", "점수"]]
```


```python
df_fac_pharm = df_fac_pharm.reset_index()
df_fac_pharm = df_fac_pharm[["구분", "법정동코드", "자치구", "동", "합계", "점수"]]
df_fac_pharm.to_csv("df_fac_pharm.csv")
df_fac_pharm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>약국</td>
      <td>11680103.0</td>
      <td>강남구</td>
      <td>개포동</td>
      <td>23.0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>약국</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>57.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>약국</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>33.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>약국</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>14.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>약국</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>33.0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>334</th>
      <td>약국</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>64.0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>335</th>
      <td>약국</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>22.0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>336</th>
      <td>약국</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>32.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>337</th>
      <td>약국</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>338</th>
      <td>약국</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>24.0</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>339 rows × 6 columns</p>
</div>



## 최종 편의점 df : df_fac_store


```python
df_fac_store = df_fac_store.reset_index()
df_fac_store = df_fac_store[["구분", "법정동코드", "자치구", "동", "합계", "점수"]]
df_fac_store.to_csv("df_fac_store.csv")
df_fac_store.isnull().sum()
```




    구분       0
    법정동코드    0
    자치구      0
    동        0
    합계       0
    점수       0
    dtype: int64



# 최종 전체 데이터프레임 : df_fac


```python
df_fac = pd.concat([df_fac_coin,df_fac_pharm,df_fac_store ], ignore_index =True)
df_fac.to_csv("df_fac.csv")
df_fac
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>코인세탁소</td>
      <td>11680108.0</td>
      <td>강남구</td>
      <td>논현동</td>
      <td>3.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>코인세탁소</td>
      <td>11680106.0</td>
      <td>강남구</td>
      <td>대치동</td>
      <td>2.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>코인세탁소</td>
      <td>11680118.0</td>
      <td>강남구</td>
      <td>도곡동</td>
      <td>2.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>3</th>
      <td>코인세탁소</td>
      <td>11680105.0</td>
      <td>강남구</td>
      <td>삼성동</td>
      <td>2.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>코인세탁소</td>
      <td>11680110.0</td>
      <td>강남구</td>
      <td>압구정동</td>
      <td>1.0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>831</th>
      <td>편의점</td>
      <td>11260101.0</td>
      <td>중랑구</td>
      <td>면목동</td>
      <td>86.0</td>
      <td>60</td>
    </tr>
    <tr>
      <th>832</th>
      <td>편의점</td>
      <td>11260104.0</td>
      <td>중랑구</td>
      <td>묵동</td>
      <td>23.0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>833</th>
      <td>편의점</td>
      <td>11260102.0</td>
      <td>중랑구</td>
      <td>상봉동</td>
      <td>37.0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>834</th>
      <td>편의점</td>
      <td>11260106.0</td>
      <td>중랑구</td>
      <td>신내동</td>
      <td>21.0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>835</th>
      <td>편의점</td>
      <td>11260103.0</td>
      <td>중랑구</td>
      <td>중화동</td>
      <td>32.0</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
<p>836 rows × 6 columns</p>
</div>




```python

```

# 시각화

## GeoJSON 임포트


```python
seoul_geo_url = "https://raw.githubusercontent.com/choiimingue/seoul_map/main/EMD_SEOUL.json"
print(seoul_geo_url)
```


```python
# 서울 시도 GeoJSON 
with urlopen(seoul_geo_url) as response:
    seoul_geojson = json.load(response)

seoul_geojson["features"][0]["properties"]
```

### 클러스터로 전체 묶어서 시각화


```python
# # 업태구분별 마크업하기!!
# latlong = df_t[["Y", "X"]].mean().values
# f_map = folium.Map(latlong, zoom_start=12,) #tiles="Stamen Toner"

# for i in df_t.index:
#     sub_lat = df_t.loc[i, "Y"]
#     sub_long = df_t.loc[i, "X"]
    
#     sub = df_t.loc[i, '업태구분명']
#     title = f"{df_t.loc[i, '동']} - {df_t.loc[i, '업태구분명']}"
#     color = {"코인세탁소" : "red", "약국": "blue", "편의점": "orange"}
    
#     folium.CircleMarker([sub_lat, sub_long],
#                         radius=3,
#                         color=color[sub],
#                         tooltip=title).add_to(f_map)
# f_map
```

# get_geo(a) : 구분별 점수로 차등 시각화


```python
# 세부구분 데이터 시각화
def get_geo(a):
    
    # 개별 데이터 지도 시각화 함수
    # 파라미터를 입력
    # a에 세부구분 넣어 지도에 시각화
    
    f_map_fac = folium.Map([37.541, 126.986], zoom_start=12)
    lst = [a]
    for i in lst :
        
        name = { "코인세탁소" : df_fac_coin, "약국" : df_fac_pharm, "편의점" : df_fac_store, 
               }
        sub = { a : 0.7,}
        
        

        # 코인세탁
        folium.Choropleth(
        geo_data=seoul_geojson,
        name='choropleth',
        data=name[i],
        columns=["법정동코드",'점수'],
        key_on='feature.properties.EMD_CD',
        fill_color='Greens',
        fill_opacity=sub[i],
        line_opacity=0.7,
        legend_name= f'동별 {i} 수'
        ).add_to(f_map_fac)
    
    return f_map_fac

```

## 코인세탁 점수 시각화


```python
get_geo("코인세탁소")
```

## 약국 점수 시각화


```python
get_geo("약국")
```

## 편의점 점수 시각화


```python
get_geo("편의점")
```

# 편의시설 우선순위에 따른 시각화 함수 구현

## 점수 비율 차등 부여 함수


```python
def geo_score(a,b,c) :
    
    f_map_fac = folium.Map([37.541, 126.986], zoom_start=12)
    lst = [a,b,c]
    
    name = { "코인세탁소" : df_fac_coin, "약국" : df_fac_pharm, "편의점" : df_fac_store, 
                   }
    sub = { a : 0.9, b : 0.6, c: 0.3 }
            
    name[a]["점수"] = name[a]["점수"] * sub[a]
    name[b]["점수"] = name[b]["점수"] * sub[b]
    name[c]["점수"] = name[c]["점수"] * sub[c]
    
    for i in lst :
        
       
        folium.Choropleth(
        geo_data=seoul_geojson,
        name='choropleth',
        data=name[i],
        columns=["법정동코드",'점수'],
        key_on='feature.properties.EMD_CD',
        fill_color='Greens',
        fill_opacity=0.5,
        line_opacity=0.5,
        legend_name= f'동별 {i} 수'
        ).add_to(f_map_fac)

  
    return f_map_fac

geo_score("약국", "편의점", "코인세탁소")

```

##  불투명도 차등 부여 함수


```python
def get_geo_op(a,b,c):
    
    # 편의시설 우선순위에 따른 지도 시각화 함수
    # 파라미터를 우선순위순으로 입력
    # 불투명도에 차이를 두어 지도에 시각화
    lst = [a, b, c]
    f_map_fac = folium.Map([37.541, 126.986], zoom_start=12)
    for i in lst :
        
        name = { "코인세탁소" : df_fac_coin, "약국" : df_fac_pharm, "편의점" : df_fac_store, 
               }
        sub = { a : 0.5, b : 0.3, c : 0.1}
        
        

        # 코인세탁
        folium.Choropleth(
        geo_data=seoul_geojson,
        name='choropleth',
        data=name[i],
        columns=["법정동코드",'합계'],
        key_on='feature.properties.EMD_CD',
        fill_color='Greens',
        fill_opacity=sub[i],
        line_opacity=0.5,
        legend_name= f'동별 {i} 수'
        ).add_to(f_map_fac)
    
    return f_map_fac

get_geo_op("약국", "편의점", "코인세탁소")
```

# 그래프 시각화


```python
import seaborn as sns
import koreanize_matplotlib

```


```python
df_fac.hist()
sns.barplot(data = df_fac, x = "구분", y ="합계" )
```




    <AxesSubplot:xlabel='구분', ylabel='합계'>




    
![png](output_149_1.png)
    



```python
lst = [df_fac_coin, df_fac_pharm, df_fac_store]
for i in lst :
    a =i.sort_values("합계", ascending = False).head(10)
    sns.barplot(data = a, x = "동", y ="합계",palette = "Reds_r")
```


    
![png](output_150_0.png)
    


## 코인세탁 상위 10개 동네


```python

a =df_fac_coin.sort_values("합계", ascending = False).head(10)
sns.barplot(data = a, x = "동", y ="합계",palette = "Reds_r")
```




    <AxesSubplot:xlabel='동', ylabel='합계'>




    
![png](output_152_1.png)
    


## 약국  상위 10개 동네


```python
b =df_fac_pharm.sort_values("합계", ascending = False).head(10)
sns.barplot(data = b, x = "동", y ="합계",palette = "Reds_r")
```




    <AxesSubplot:xlabel='동', ylabel='합계'>




    
![png](output_154_1.png)
    


## 편의점 상위 10개 동네


```python
c =df_fac_store.sort_values("합계", ascending = False).head(10)
sns.barplot(data = c, x = "동", y ="합계",palette = "Reds_r")
```




    <AxesSubplot:xlabel='동', ylabel='합계'>




    
![png](output_156_1.png)
    



```python
df_fac.loc[df_fac["동"] == "화양동"]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>구분</th>
      <th>법정동코드</th>
      <th>자치구</th>
      <th>동</th>
      <th>합계</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>코인세탁소</td>
      <td>11215107.0</td>
      <td>광진구</td>
      <td>화양동</td>
      <td>1.0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>175</th>
      <td>약국</td>
      <td>11215107.0</td>
      <td>광진구</td>
      <td>화양동</td>
      <td>9.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>515</th>
      <td>편의점</td>
      <td>11215107.0</td>
      <td>광진구</td>
      <td>화양동</td>
      <td>25.0</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
